<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="description" content="this is a blog"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Python socket编程 · gzmviavia</title><link rel="short icon" href="/favicon.ico"><!-- font--><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600|Roboto Mono"><!-- icon--><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><!-- theme style--><link rel="stylesheet" href="/css/style.css"><!-- baidu analytics--><script type="text/javascript">var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?9e0cbea7d3319c6c94c71dfb93c151b8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><!-- google analytics--><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-74273646-1', 'auto');
ga('send', 'pageview');</script></head><body><div id="main"><header><a href="/." class="logo">gzmviavia</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">首页</a></li><li class="nav-link"><a href="/archives/" target="_self">归档</a></li><li class="nav-link"><a href="/categories/" target="_self">分类</a></li><li class="nav-link"><a href="/tags/" target="_self">标签</a></li><li class="nav-link"><a href="/about/" target="_self">关于</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">Python socket编程</h1><span class="post-time">2016年8月25日</span><div id="sidebar" class="post-sidebar"><h3 class="heading">目录</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建socket对象"><span class="toc-text">创建socket对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#设置socket选项"><span class="toc-text">设置socket选项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#绑定地址和端口号"><span class="toc-text">绑定地址和端口号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#监听地址和端口号"><span class="toc-text">监听地址和端口号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#客户端连接服务器"><span class="toc-text">客户端连接服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#服务器获取远程连接的socket"><span class="toc-text">服务器获取远程连接的socket</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#接收数据"><span class="toc-text">接收数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#发送数据"><span class="toc-text">发送数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关闭远程连接的socket"><span class="toc-text">关闭远程连接的socket</span></a></li></ol></div><div class="post-content"><p>socket&#x662F;&#x7F51;&#x7EDC;&#x7F16;&#x7A0B;&#x7684;&#x57FA;&#x7840;&#xFF0C;socket&#x4E3A;&#x6211;&#x4EEC;&#x63D0;&#x4F9B;&#x4E86;&#x64CD;&#x7EB5;TCP&#x548C;UDP&#x7684;&#x63A5;&#x53E3;&#x3002;&#x6240;&#x4EE5;&#x8981;&#x5148;&#x5B66;&#x597D;TCP/IP&#x7406;&#x8BBA;&#xFF0C;&#x7136;&#x540E;&#x5B66;&#x4E60;socket&#x7F16;&#x7A0B;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6839;&#x636E;socket&#x63D0;&#x4F9B;&#x7684;&#x5404;&#x79CD;API&#x63A5;&#x53E3;&#xFF0C;&#x8FD4;&#x56DE;&#x53BB;&#x770B;TCP/IP&#x7406;&#x8BBA;&#xFF0C;&#x4ECE;&#x800C;&#x52A0;&#x6DF1;&#x5BF9;TCP/IP&#x7406;&#x8BBA;&#x7684;&#x7406;&#x89E3;&#x3002;</p>
<a id="more"></a>
<p>socket&#x662F;&#x5E94;&#x7528;&#x5C42;&#x4E0E;TCP/IP&#x534F;&#x8BAE;&#x65CF;&#x901A;&#x4FE1;&#x7684;&#x4E2D;&#x95F4;&#x8F6F;&#x4EF6;&#x62BD;&#x8C61;&#x5C42;&#xFF0C;&#x5B83;&#x662F;&#x4E00;&#x7EC4;&#x63A5;&#x53E3;&#xFF0C;&#x5B83;&#x628A;&#x590D;&#x6742;&#x7684;&#x5B9E;&#x73B0;&#x9690;&#x85CF;&#x5728;&#x4E86;&#x63A5;&#x53E3;&#x540E;&#x9762;&#xFF0C;&#x7528;&#x6237;&#x901A;&#x8FC7;&#x63A5;&#x53E3;&#x8BA9;socket&#x53BB;&#x7EC4;&#x7EC7;&#x6570;&#x636E;&#xFF0C;&#x4EE5;&#x7B26;&#x5408;&#x6307;&#x5B9A;&#x7684;&#x534F;&#x8BAE;&#x3002;&#x5982;&#x4E0B;&#x56FE;&#xFF0C;&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#x901A;&#x8FC7;socket&#x62BD;&#x8C61;&#x5C42;&#xFF0C;&#x64CD;&#x7EB5;&#x7740;&#x5404;&#x79CD;&#x534F;&#x8BAE;&#x3002;</p>
<p><img src="/2016/08/25/socket/socket.png" alt="socket"></p>
<h2 id="&#x521B;&#x5EFA;socket&#x5BF9;&#x8C61;"><a href="#&#x521B;&#x5EFA;socket&#x5BF9;&#x8C61;" class="headerlink" title="&#x521B;&#x5EFA;socket&#x5BF9;&#x8C61;"></a>&#x521B;&#x5EFA;socket&#x5BF9;&#x8C61;</h2><p>python&#x7684;<code>socket</code>&#x6A21;&#x5757;&#x4E3A;&#x6211;&#x4EEC;&#x63D0;&#x4F9B;&#x4E86;socket&#x7F16;&#x7A0B;&#x76F8;&#x5173;&#x7684;API&#xFF0C;&#x4F7F;&#x7528;&#x8BE5;&#x6A21;&#x5757;&#x4E2D;&#x7684;<code>socket.socket(family, type, protocol)</code>&#x51FD;&#x6570;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;socket&#x5BF9;&#x8C61;&#x3002;<br>&#x5176;&#x4E2D;family&#x7528;&#x6765;&#x6307;&#x660E;&#x5730;&#x5740;&#x5BB6;&#x65CF;&#xFF08;address family&#xFF09;&#xFF0C;&#x53EF;&#x7528;&#x7684;&#x503C;&#x6709;&#xFF1A;</p>
<ul>
<li><code>socket.AF_UNIX</code>&#xFF0C;&#x8868;&#x660E;&#x4F7F;&#x7528;&#x5728;&#x540C;&#x4E00;&#x53F0;&#x673A;&#x5668;&#x4E0A;&#x7684;&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#x7684;TCP&#x548C;UDP&#x901A;&#x4FE1;&#x3002;</li>
<li><code>socket.AF_INET</code>&#xFF0C;&#x8868;&#x660E;&#x4F7F;&#x7528;IPV4&#x534F;&#x8BAE;&#x7684;TCP&#x548C;UDP&#x901A;&#x4FE1;&#x3002;</li>
<li><code>socket.AF_INET6</code>&#xFF0C;&#x8868;&#x660E;&#x4F7F;&#x7528;IPV4&#x534F;&#x8BAE;&#x7684;TCP&#x548C;UDP&#x901A;&#x4FE1;&#x3002;</li>
</ul>
<p>type&#x7528;&#x6765;&#x6307;&#x660E;socket&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x7684;&#x503C;&#x6709;&#xFF1A;</p>
<ul>
<li><code>socket.SOCK_STREAM</code>&#xFF0C;&#x8868;&#x660E;&#x8FD9;&#x4E2A;&#x5957;&#x63A5;&#x5B57;&#x662F;&#x4F7F;&#x7528;TCP&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;</li>
<li><code>socket.DGRAM</code>&#xFF0C;&#x8868;&#x660E;&#x8FD9;&#x4E2A;&#x5957;&#x63A5;&#x5B57;&#x662F;&#x4F7F;&#x7528;UDP&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;</li>
<li><code>socket.RAW</code>&#xFF0C;&#x8868;&#x660E;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x539F;&#x59CB;&#x5957;&#x63A5;&#x5B57;&#xFF0C;&#x4F7F;&#x7528;&#x8BE5;&#x5957;&#x63A5;&#x5B57;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x6784;&#x9020;TCP&#x5934;&#xFF0C;IP&#x5934;&#xFF0C;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x534F;&#x8BAE;&#x5934;&#x7B49;&#x3002;&#x9ED1;&#x5BA2;&#x5C31;&#x662F;&#x4F7F;&#x7528;&#x8BE5;&#x5957;&#x63A5;&#x5B57;&#x4F2A;&#x9020;&#x62A5;&#x6587;&#x7684;&#x3002;</li>
</ul>
<p>protocol&#x7528;&#x6765;&#x6307;&#x660E;&#x534F;&#x8BAE;&#x7C7B;&#x578B;&#xFF0C;&#x4E00;&#x822C;&#x53EA;&#x6709;type&#x662F;<code>socket.RAW</code>&#x65F6;&#x624D;&#x9700;&#x8981;&#x6307;&#x5B9A;&#xFF0C;&#x8868;&#x660E;&#x9700;&#x8981;&#x53D1;&#x9001;/&#x63A5;&#x6536;&#x4EC0;&#x4E48;&#x534F;&#x8BAE;&#x7C7B;&#x578B;&#x7684;&#x5305;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;TCP&#x7C7B;&#x578B;&#x7684;<code>socket</code>&#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x8FD9;&#x4E48;&#x505A;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sock  = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div></pre></td></tr></table></figure></p>
<h2 id="&#x8BBE;&#x7F6E;socket&#x9009;&#x9879;"><a href="#&#x8BBE;&#x7F6E;socket&#x9009;&#x9879;" class="headerlink" title="&#x8BBE;&#x7F6E;socket&#x9009;&#x9879;"></a>&#x8BBE;&#x7F6E;socket&#x9009;&#x9879;</h2><p>&#x5177;&#x6709;&#x90FD;&#x6709;&#x54EA;&#x4E9B;&#x9009;&#x9879;&#xFF0C;<a href="http://blog.csdn.net/luozenghui529480823/article/details/13511235" target="_blank" rel="external">&#x770B;&#x8FD9;&#x91CC;</a>&#xFF0C;<a href="http://blog.sina.com.cn/s/blog_4c8529bb01014977.html" target="_blank" rel="external">&#x8FD8;&#x6709;&#x8FD9;&#x91CC;</a></p>
<h2 id="&#x7ED1;&#x5B9A;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;"><a href="#&#x7ED1;&#x5B9A;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;" class="headerlink" title="&#x7ED1;&#x5B9A;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;"></a>&#x7ED1;&#x5B9A;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;</h2><p>&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>bind</code>&#x51FD;&#x6570;&#x628A;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x7684;IP&#x5730;&#x5740;&#x7ED1;&#x5B9A;&#x5230;&#x5957;&#x63A5;&#x5B57;&#x4E0A;&#xFF0C;&#x4E0D;&#x8FC7;&#x8FD9;&#x4E2A;IP&#x5730;&#x5740;&#x5FC5;&#x987B;&#x662F;&#x672C;&#x673A;&#x7684;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#x4E4B;&#x4E00;&#x3002;</p>
<ul>
<li>&#x5BF9;&#x4E8E;TCP&#x5BA2;&#x6237;&#x7AEF;&#x6765;&#x8BF4;&#xFF0C;&#x8FD9;&#x5C31;&#x4E3A;&#x8BE5;&#x5957;&#x63A5;&#x5B57;&#x4E0A;&#x53D1;&#x9001;&#x7684;IP&#x6570;&#x636E;&#x62A5;&#x6307;&#x5B9A;&#x4E86;&#x6E90;IP&#x5730;&#x5740;&#x3002;&#x4E0D;&#x8FC7;TCP&#x5BA2;&#x6237;&#x7AEF;&#x901A;&#x5E38;&#x90FD;&#x4E0D;&#x628A;IP&#x5730;&#x5740;&#x7ED1;&#x5B9A;&#x5230;&#x5B83;&#x7684;&#x5957;&#x63A5;&#x5B57;&#x4E0A;&#xFF0C;&#x5F53;&#x5957;&#x63A5;&#x5B57;&#x8FDE;&#x63A5;&#x65F6;&#xFF0C;&#x5185;&#x6838;&#x6839;&#x636E;&#x6240;&#x7528;&#x7684;&#x5916;&#x51FA;&#x7F51;&#x7EDC;&#x7684;&#x63A5;&#x53E3;&#x6765;&#x9009;&#x62E9;&#x6E90;IP&#x5730;&#x5740;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5BA2;&#x6237;&#x7AEF;&#x7684;socket&#x901A;&#x5E38;&#x90FD;&#x4E0D;&#x9700;&#x8981;&#x8C03;&#x7528;<code>bind</code>&#x51FD;&#x6570;&#x3002;</li>
<li>&#x5BF9;&#x4E8E;TCP&#x670D;&#x52A1;&#x5668;&#x6765;&#x8BF4;&#xFF0C;&#x8FD9;&#x5C31;&#x9650;&#x5B9A;&#x4E86;&#x8BE5;&#x5957;&#x63A5;&#x5B57;&#x53EA;&#x63A5;&#x6536;&#x90A3;&#x4E9B;&#x76EE;&#x7684;&#x5730;&#x5740;&#x4E3A;&#x8FD9;&#x4E2A;IP&#x5730;&#x5740;&#x7684;&#x5BA2;&#x6237;&#x8FDE;&#x63A5;&#x3002;&#x5982;&#x679C;TCP&#x670D;&#x52A1;&#x5668;&#x6CA1;&#x6709;&#x628A;IP&#x5730;&#x5740;&#x7ED1;&#x5B9A;&#x5230;&#x5B83;&#x7684;&#x5957;&#x63A5;&#x5B57;&#x4E0A;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x628A;&#x5BA2;&#x6237;&#x53D1;&#x9001;&#x7684;SYN&#x7684;&#x76EE;&#x7684;&#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x670D;&#x52A1;&#x5668;&#x7684;&#x6E90;IP&#x5730;&#x5740;&#x3002;</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#sock.bind((HOST, PORT))</span></div><div class="line">sock.bind((<span class="string">&apos;192.168.1.1&apos;</span>, <span class="number">5678</span>))</div></pre></td></tr></table></figure>
<p>&#x53C2;&#x6570;PORT&#x53EF;&#x4EE5;&#x4E3A;0&#xFF0C;&#x4E3A;0&#x4EE3;&#x8868;&#x8BA9;&#x5185;&#x6838;&#x4E3A;&#x5957;&#x63A5;&#x5B57;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x4E34;&#x65F6;&#x7AEF;&#x53E3;&#x53F7;&#xFF0C;&#x4E3A;&#x4E86;&#x83B7;&#x5F97;&#x8FD9;&#x4E2A;&#x7AEF;&#x53E3;&#x53F7;&#xFF0C;&#x8981;&#x4F7F;&#x7528;<code>getsockname</code>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sock.bind((&apos;192.168.1.1&apos;, 0))</div><div class="line">print sock.getsockname()</div></pre></td></tr></table></figure>
<p>&#x8C03;&#x7528;<code>bind</code>&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;IP&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x90FD;&#x4E0D;&#x6307;&#x5B9A;&#xFF0C;&#x5404;&#x79CD;&#x7ED3;&#x679C;&#x5982;&#x56FE;&#x6240;&#x793A;&#x3002;</p>
<p><img src="/2016/08/25/socket/socket_bind.png" alt="socket\_bind"></p>
<h2 id="&#x76D1;&#x542C;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;"><a href="#&#x76D1;&#x542C;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;" class="headerlink" title="&#x76D1;&#x542C;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;"></a>&#x76D1;&#x542C;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;</h2><p><code>listen(backlog)</code>&#x51FD;&#x6570;&#x4EC5;&#x7531;TCP&#x670D;&#x52A1;&#x5668;&#x8C03;&#x7528;&#xFF0C;&#x4E00;&#x4E2A;&#x5957;&#x63A5;&#x5B57;&#x8C03;&#x7528;<code>listen</code>&#x51FD;&#x6570;&#x4E4B;&#x540E;&#xFF0C;&#x8BE5;&#x5957;&#x63A5;&#x5B57;&#x5C31;&#x4ECE;&#x4E00;&#x4E2A;&#x672A;&#x8FDE;&#x63A5;&#x5957;&#x63A5;&#x5B57;&#x53D8;&#x6210;&#x4E86;&#x88AB;&#x52A8;&#x5957;&#x63A5;&#x5B57;&#xFF0C;&#x8BE5;&#x88AB;&#x52A8;&#x5957;&#x63A5;&#x5B57;&#x80FD;&#x591F;&#x63A5;&#x53D7;&#x8FDC;&#x7A0B;&#x5957;&#x63A5;&#x5B57;&#x7684;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x3002;</p>
<p>TCP&#x4E3A;&#x76D1;&#x542C;&#x5957;&#x63A5;&#x5B57;&#x7EF4;&#x62A4;&#x4E24;&#x4E2A;&#x961F;&#x5217;&#xFF0C;&#x5206;&#x522B;&#x662F;&#x672A;&#x5B8C;&#x6210;&#x8FDE;&#x63A5;&#x961F;&#x5217;&#x548C;&#x5DF2;&#x5B8C;&#x6210;&#x8FDE;&#x63A5;&#x961F;&#x5217;&#x3002;</p>
<ul>
<li>&#x672A;&#x5B8C;&#x6210;&#x8FDE;&#x63A5;&#x961F;&#x5217;&#xFF0C;&#x6BCF;&#x4E2A;SYN&#x5206;&#x7EC4;&#x5BF9;&#x4E8E;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x9879;&#xFF0C;&#x8FD9;&#x4E9B;SYN&#x5206;&#x7EC4;&#x662F;&#x7531;&#x5BA2;&#x6237;&#x7AEF;&#x53D1;&#x6765;&#x7684;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x6B63;&#x7B49;&#x5F85;&#x5B8C;&#x6210;&#x76F8;&#x5E94;&#x7684;TCP&#x4E09;&#x6B21;&#x63E1;&#x624B;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x8FD9;&#x4E9B;&#x5957;&#x63A5;&#x5B57;&#x90FD;&#x5904;&#x4E8E;<strong>SYN_RCVD</strong>&#x72B6;&#x6001;&#x3002;</li>
<li>&#x5DF2;&#x5B8C;&#x6210;&#x8FDE;&#x63A5;&#x961F;&#x5217;&#xFF0C;&#x6BCF;&#x4E2A;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x4E09;&#x6B21;&#x63E1;&#x624B;&#x7684;&#x5BA2;&#x6237;&#x5BF9;&#x5E94;&#x5176;&#x4E2D;&#x4E00;&#x9879;&#xFF0C;&#x8FD9;&#x4E9B;&#x5957;&#x63A5;&#x5B57;&#x5904;&#x4E8E;<strong>ESTABLISHED</strong>&#x72B6;&#x6001;&#x3002;<br><img src="/2016/08/25/socket/socket_listen.png" alt="socket\_listen"></li>
</ul>
<p><code>backlog</code>&#x53C2;&#x6570;&#x66FE;&#x7ECF;&#x88AB;&#x89C4;&#x5B9A;&#x4E3A;<strong>&#x4E24;&#x4E2A;&#x961F;&#x5217;&#x603B;&#x548C;&#x7684;&#x6700;&#x5927;&#x503C;</strong>&#xFF0C;&#x4F46;&#x662F;&#x73B0;&#x5728;&#x7684;<code>backlog</code>&#x53C2;&#x6570;&#x662F;&#x6307;<strong>&#x5DF2;&#x5B8C;&#x6210;&#x961F;&#x5217;&#x7684;&#x6700;&#x5927;&#x503C;</strong>&#x3002;<br><code>backlog</code>&#x53C2;&#x6570;&#x5982;&#x679C;&#x662F;&#x4E24;&#x4E2A;&#x961F;&#x5217;&#x7684;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x53D1;&#x751F;&#x8FD9;&#x4E48;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x9ED1;&#x5BA2;&#x4EE5;&#x9AD8;&#x901F;&#x7387;&#x5411;&#x53D7;&#x5BB3;&#x4E3B;&#x673A;&#x53D1;&#x9001;SYN&#x62A5;&#x6587;&#xFF0C;&#x90A3;&#x4E48;&#x672A;&#x5B8C;&#x6210;&#x961F;&#x5217;&#x5C31;&#x662F;&#x6EE1;&#x7684;&#xFF0C;&#x5F53;&#x961F;&#x5217;&#x662F;&#x6EE1;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x4E22;&#x5F03;&#x90A3;&#x4E9B;&#x53D1;&#x6765;&#x7684;SYN&#x62A5;&#x6587;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x79CD;&#x653B;&#x51FB;&#x53EB;&#x505A;&#x62D2;&#x7EDD;&#x670D;&#x52A1;&#xFF08;denial service&#xFF09;&#x653B;&#x51FB;&#x3002;<br>&#x6240;&#x4EE5;&#x73B0;&#x5728;&#x7684;<code>backlog</code>&#x53C2;&#x6570;&#x662F;&#x6307;&#x5DF2;&#x5B8C;&#x6210;&#x961F;&#x5217;&#x7684;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x5BF9;&#x4E8E;&#x5DF2;&#x5B8C;&#x6210;&#x8FDE;&#x63A5;&#x6570;&#x76EE;&#x505A;&#x51FA;&#x9650;&#x5B9A;&#x7684;&#x76EE;&#x7684;&#x5728;&#x4E8E;&#xFF1A;&#x5728;&#x76D1;&#x542C;&#x67D0;&#x4E2A;&#x5957;&#x63A5;&#x5B57;&#x7684;&#x5E94;&#x7528;&#x8FDB;&#x7A0B;&#x56E0;&#x4E3A;&#x67D0;&#x79CD;&#x539F;&#x56E0;&#x4E0D;&#x8C03;&#x7528;<code>accept</code>&#x63A5;&#x53D7;&#x5DF2;&#x5B8C;&#x6210;&#x8FDE;&#x63A5;&#x65F6;&#xFF0C;&#x9632;&#x6B62;&#x5185;&#x6838;&#x5728;&#x8BE5;&#x5957;&#x63A5;&#x5B57;&#x4E0A;&#x7EE7;&#x7EED;&#x63A5;&#x53D7;&#x65B0;&#x7684;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x3002;</p>
<p><code>backlog</code>&#x7684;&#x6700;&#x5927;&#x503C;&#x662F;5&#xFF0C;&#x6BCF;&#x5F53;&#x76D1;&#x542C;&#x5957;&#x63A5;&#x5B57;&#x8C03;&#x7528;<code>accept</code>&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x5C31;&#x4ECE;&#x5DF2;&#x5B8C;&#x6210;&#x8FDE;&#x63A5;&#x961F;&#x5217;&#x7684;&#x961F;&#x9996;&#x53D6;&#x51FA;&#x4E00;&#x4E2A;&#x5DF2;&#x5B8C;&#x6210;&#x7684;&#x8FDE;&#x63A5;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sock.listen(<span class="number">5</span>)</div></pre></td></tr></table></figure></p>
<h2 id="&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x670D;&#x52A1;&#x5668;"><a href="#&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x670D;&#x52A1;&#x5668;" class="headerlink" title="&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x670D;&#x52A1;&#x5668;"></a>&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x670D;&#x52A1;&#x5668;</h2><p>TCP&#x5BA2;&#x6237;&#x4F7F;&#x7528;&#x4F7F;&#x7528;<code>connect</code>&#x51FD;&#x6570;&#x6765;&#x4E0E;TCP&#x670D;&#x52A1;&#x5668;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#xFF0C;&#x5373;&#x6FC0;&#x53D1;&#x4E86;&#x4E09;&#x6B21;&#x63E1;&#x624B;&#x8FC7;&#x7A0B;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x5728;&#x5EFA;&#x7ACB;&#x6210;&#x529F;&#x6216;&#x8005;&#x53D1;&#x9001;&#x9519;&#x8BEF;&#x65F6;&#x8FD4;&#x56DE;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#sock.connect((HOST, PORT))</span></div><div class="line">sock  = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line">sock.connect((<span class="string">&apos;192.168.1.1&apos;</span>, <span class="number">5678</span>))</div></pre></td></tr></table></figure></p>
<h2 id="&#x670D;&#x52A1;&#x5668;&#x83B7;&#x53D6;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#x7684;socket"><a href="#&#x670D;&#x52A1;&#x5668;&#x83B7;&#x53D6;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#x7684;socket" class="headerlink" title="&#x670D;&#x52A1;&#x5668;&#x83B7;&#x53D6;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#x7684;socket"></a>&#x670D;&#x52A1;&#x5668;&#x83B7;&#x53D6;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#x7684;socket</h2><p>TCP&#x670D;&#x52A1;&#x5668;&#x4F7F;&#x7528;<code>accept</code>&#x4ECE;&#x5DF2;&#x5B8C;&#x6210;&#x8FDE;&#x63A5;&#x961F;&#x5217;&#x961F;&#x9996;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5DF2;&#x5B8C;&#x6210;&#x7684;&#x8FDE;&#x63A5;&#xFF0C;&#x5982;&#x679C;&#x961F;&#x5217;&#x4E3A;&#x7A7A;&#xFF0C;&#x90A3;&#x4E48;&#x8FDB;&#x7A0B;&#x4F1A;&#x88AB;&#x963B;&#x585E;&#xFF08;&#x5982;&#x679C;&#x5957;&#x63A5;&#x5B57;&#x662F;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x7684;&#x963B;&#x585E;&#x6A21;&#x5F0F;&#xFF09;&#x3002;<br>&#x5982;&#x679C;<code>accept</code>&#x6210;&#x529F;&#xFF0C;&#x8FD4;&#x56DE;&#x4E0E;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x7684;socket&#xFF0C;&#x5DF2;&#x7ECF;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x5730;&#x5740;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">client_sock, client_addr = sock.accept()</div></pre></td></tr></table></figure></p>
<h2 id="&#x63A5;&#x6536;&#x6570;&#x636E;"><a href="#&#x63A5;&#x6536;&#x6570;&#x636E;" class="headerlink" title="&#x63A5;&#x6536;&#x6570;&#x636E;"></a>&#x63A5;&#x6536;&#x6570;&#x636E;</h2><ul>
<li><code>recv(bufsize)</code> : &#x4ECE;socket&#x7684;&#x63A5;&#x6536;&#x7F13;&#x51B2;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#xFF0C;&#x6700;&#x591A;&#x8BFB;&#x53D6;bufsize&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5982;&#x679C;&#x63A5;&#x6536;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x6CA1;&#x6709;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x9ED8;&#x8BA4;&#x4F1A;&#x963B;&#x585E;&#x3002;</li>
<li><code>recvfrom(bufsize)</code> : &#x540C;<code>recv(bufsize)</code>&#xFF0C;&#x4E0D;&#x540C;&#x8FD4;&#x56DE;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x4E8C;&#x5143;&#x7EC4;<code>(data, address)</code>&#xFF0C;address&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x4E8C;&#x5143;&#x7EC4;(HOST, PORT)&#xFF0C;&#x5373;&#x5957;&#x5957;&#x63A5;&#x5B57;&#x53E6;&#x4E00;&#x7AEF;&#x4E3B;&#x673A;&#x7684;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;</li>
</ul>
<h2 id="&#x53D1;&#x9001;&#x6570;&#x636E;"><a href="#&#x53D1;&#x9001;&#x6570;&#x636E;" class="headerlink" title="&#x53D1;&#x9001;&#x6570;&#x636E;"></a>&#x53D1;&#x9001;&#x6570;&#x636E;</h2><ul>
<li><code>send(data)</code> : &#x53D1;&#x9001;&#x6570;&#x636E;&#x7ED9;&#x5957;&#x63A5;&#x5B57;&#x53E6;&#x4E00;&#x7AEF;&#x7684;&#x4E3B;&#x673A;&#xFF0C;&#x5982;&#x679C;data&#x6BD4;&#x53D1;&#x9001;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x8FD8;&#x5927;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x4E22;&#x5F03;&#x591A;&#x4F59;&#x7684;&#x6570;&#x636E;&#x3002;&#x8BE5;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5DF2;&#x53D1;&#x9001;&#x7684;&#x5B57;&#x8282;&#x6570;&#x3002; &#x6240;&#x4EE5;&#x5E94;&#x7528;&#x8FDB;&#x7A0B;&#x5FC5;&#x987B;&#x81EA;&#x5DF1;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x90FD;&#x53D1;&#x9001;&#x51FA;&#x53BB;&#x4E86;&#x3002;</li>
<li><code>sendall(data)</code> : &#x8BE5;&#x51FD;&#x6570;&#x4F1A;&#x628A;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x90FD;&#x53D1;&#x9001;&#x51FA;&#x53BB;&#x4E86;&#x624D;&#x8FD4;&#x56DE;&#x3002;</li>
<li><code>sendto(data,address)</code> : &#x4E0A;&#x9762;&#x7684;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x90FD;&#x8981;&#x6C42;&#x5957;&#x63A5;&#x5B57;&#x5DF2;&#x7ECF;&#x548C;&#x8FDC;&#x7AEF;&#x7684;&#x4E3B;&#x673A;&#x5EFA;&#x7ACB;&#x4E86;&#x8FDE;&#x63A5;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x8981;&#x6C42;&#x6CA1;&#x6709;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#xFF0C;&#x6240;&#x6709;&#x8981;&#x5728;&#x53C2;&#x6570;&#x4E2D;&#x6307;&#x5B9A;&#x8FDC;&#x7AEF;&#x4E3B;&#x673A;&#x7684;address&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x6839;&#x636E;&#x53C2;&#x6570;address&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#xFF0C;&#x7136;&#x540E;&#x4E4B;&#x540E;&#x7684;&#x884C;&#x4E3A;&#x548C;&#x51FD;&#x6570;<code>recv(data)</code>&#x4E00;&#x6837;&#x3002;</li>
</ul>
<h2 id="&#x5173;&#x95ED;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#x7684;socket"><a href="#&#x5173;&#x95ED;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#x7684;socket" class="headerlink" title="&#x5173;&#x95ED;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#x7684;socket"></a>&#x5173;&#x95ED;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#x7684;socket</h2><p>A&#x4F7F;&#x7528;<code>close</code>&#x51FD;&#x6570;&#x4F1A;&#x5173;&#x95ED;&#x8FDE;&#x63A5;&#xFF0C;&#x5982;&#x679C;&#x5957;&#x63A5;&#x5B57;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x8FD8;&#x6709;&#x6570;&#x636E;&#x6CA1;&#x6709;&#x53D1;&#x9001;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8776;&#x7948;&#xFF0C;&#x7136;&#x540E;&#x53D1;&#x51FA;FIN&#x62A5;&#x6587;&#xFF0C;&#x800C;&#x5BF9;&#x65B9;B&#x4F1A;&#x56DE;&#x5E94;&#x4E00;&#x4E2A;ACK&#x62A5;&#x6587;&#x3002;&#x90A3;&#x4E48;&#x6B64;&#x540E;A&#x5230;B&#x8FD9;&#x4E00;&#x65B9;&#x5411;&#x7684;&#x8FDE;&#x63A5;&#x5C31;&#x5173;&#x95ED;&#x4E86;&#xFF0C;&#x4F46;&#x662F;B&#x5230;A&#x8FD9;&#x4E00;&#x65B9;&#x5411;&#x7684;&#x8FDE;&#x63A5;&#x5374;&#x6CA1;&#x6709;&#x5173;&#x95ED;&#x3002;<br>&#x6B64;&#x65F6;&#xFF0C;&#x8BE5;&#x8FDE;&#x63A5;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x534A;&#x8FDE;&#x63A5;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;B&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x5411;A&#x53D1;&#x9001;&#x6570;&#x636E;&#xFF0C;&#x6309;&#x7167;TCP/IP&#x534F;&#x8BAE;&#xFF0C;&#x6B64;&#x65F6;A&#x4E5F;&#x5E94;&#x8BE5;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x3002;&#x4F46;&#x662F;&#x5982;&#x679C;<code>close</code>&#x4E4B;&#x540E;&#x518D;&#x8C03;&#x7528;<code>recv</code>&#x51FD;&#x6570;&#x4F1A;&#x5F15;&#x53D1;&#x4E00;&#x4E2A;<code>socket.error: [Errno 9] Bad file descriptor</code>&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x5982;&#x679C;&#x60F3;&#x5728;&#x8FDE;&#x63A5;&#x53D8;&#x6210;&#x534A;&#x8FDE;&#x63A5;&#x65F6;&#x8FD8;&#x80FD;&#x591F;&#x63A5;&#x6536;&#x6570;&#x636E;&#xFF0C;&#x5219;&#x5E94;&#x8BE5;&#x8C03;&#x7528;<code>shutdown(socket.SHUT_WR)</code>&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x5173;&#x95ED;&#x8FDE;&#x63A5;&#x7684;&#x5199;&#x534A;&#x90E8;&#xFF08;&#x4F7F;&#x7528;SHUT_WR&#x53C2;&#x6570;&#xFF09;&#xFF0C;&#x53EF;&#x4EE5;&#x5173;&#x95ED;&#x8FDE;&#x63A5;&#x7684;&#x8BFB;&#x534A;&#x90E8;&#xFF08;&#x4F7F;&#x7528;SHUT_RD&#x53C2;&#x6570;&#xFF09;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x5173;&#x95ED;&#x8BFB;&#x534A;&#x90E8;&#x548C;&#x5199;&#x534A;&#x90E8;&#xFF08;&#x4F7F;&#x7528;SHUT_RDWD&#x53C2;&#x6570;&#xFF09;&#x3002;</p>
<ul>
<li>&#x4F7F;&#x7528;SHUT\WR&#x53C2;&#x6570;&#x5173;&#x95ED;&#x5199;&#x534A;&#x90E8;&#x65F6;&#xFF0C;&#x4F1A;&#x53D1;&#x9001;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x5C1A;&#x672A;&#x53D1;&#x9001;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x800C;&#x4E0D;&#x4F1A;&#x50CF;<code>close</code>&#x51FD;&#x6570;&#x90A3;&#x6837;&#x4E22;&#x5F03;&#x3002;&#x5173;&#x95ED;&#x5199;&#x534A;&#x90E8;&#x540E;&#xFF0C;&#x5C31;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x8BE5;&#x5957;&#x63A5;&#x5B57;&#x53D1;&#x9001;&#x6570;&#x636E;&#x4E86;&#x3002;</li>
<li>&#x4F7F;&#x7528;SHUT_RD&#x53C2;&#x6570;&#x5173;&#x95ED;&#x8BFB;&#x534A;&#x90E8;&#x5E76;&#x4E0D;&#x4F1A;&#x53D1;&#x51FA;FIN&#x62A5;&#x6587;&#x7ED9;&#x62A5;&#x6587;&#xFF0C;&#x5173;&#x95ED;&#x8BFB;&#x534A;&#x90E8;&#x540E;&#xFF0C;&#x8BE5;&#x5957;&#x63A5;&#x5B57;&#x4F1A;&#x4E22;&#x5F03;&#x5F53;&#x524D;&#x63A5;&#x6536;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#xFF0C;&#x4E4B;&#x540E;&#x4F1A;&#x5BF9;&#x5BF9;&#x7AEF;&#x53D1;&#x6765;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x786E;&#x8BA4;&#xFF0C;&#x4F46;&#x662F;&#x7D27;&#x63A5;&#x7740;&#x5C31;&#x4E22;&#x5F03;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#xFF0C;&#x5E76;&#x4E0D;&#x4F1A;&#x653E;&#x5230;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#xFF0C;&#x5BF9;&#x8BBE;&#x7F6E;&#x4E86;&#x8BFB;&#x534A;&#x90E8;&#x7684;&#x7684;&#x5957;&#x63A5;&#x5B57;&#x8C03;&#x7528;<code>recv</code>&#x51FD;&#x6570;&#x5E76;&#x4E0D;&#x4F1A;&#x963B;&#x585E;&#xFF0C;&#x800C;&#x662F;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#x7A7A;&#x3002;</li>
</ul>
<p><br><br>&#x53C2;&#x8003;&#xFF1A;<br><a href="http://blog.csdn.net/firefoxbug/article/details/7561159" target="_blank" rel="external">linux&#x4E0B;RAW SOCKET</a><br><a href="http://www.cnblogs.com/uvsjoh/archive/2012/12/31/2840883.html" target="_blank" rel="external">Linux raw socket</a></p>
</div></article><div class="tags"><a href="/tags/计算机网络/">计算机网络</a><a href="/tags/Python/">Python</a><a href="/tags/socket/">socket</a></div><div class="paginator"><a href="/2016/09/01/socket-fileobj/" class="prev"><i class="iconfont icon-left"></i><span> 上一页</span></a><a href="/2016/08/24/io-model/" class="next"><span>下一页</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div id="disqus_thread"></div></section><script type="text/javascript">(function() {
var d = document, s = d.createElement('script');

s.src = '//ahonn.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script></section><footer><div class="copyright"><p>&copy;2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">gzmviavia</span></p><p class="theme">Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div></body><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></html>